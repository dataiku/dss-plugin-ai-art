// TODO: add installation instructions for git and lfs
{
    "meta": {
        "label": "Download Stable Diffusion weights",
        "description": "Download Stable Diffusion weights from Hugging Face to a managed folder",
        "icon": "icon-download"
    },
    "impersonate": true,
    "paramsPythonSetup": "compute_model_revisions.py",
    "params": [
        {
            "name": "weights_folder",
            "label": "Weights folder",
            "type": "MANAGED_FOLDER",
            "description": "Folder that the weights will be downloaded to",
            "mandatory": true
        },
        // TODO: add a disclaimer about the model's license (CreativeML Open RAIL-M)
        {
            "name": "model_repo",
            "label": "Model repo",
            "type": "SELECT",
            "description": "Hugging Face repo to download the weights from",
            "defaultValue": "CompVis/stable-diffusion-v1-4",
            "mandatory": true,
            "selectChoices": [
                {"value": "CompVis/stable-diffusion-v1-1", "label": "CompVis/stable-diffusion-v1-1"},
                {"value": "CompVis/stable-diffusion-v1-2", "label": "CompVis/stable-diffusion-v1-2"},
                {"value": "CompVis/stable-diffusion-v1-3", "label": "CompVis/stable-diffusion-v1-3"},
                {"value": "CompVis/stable-diffusion-v1-4", "label": "CompVis/stable-diffusion-v1-4"},
                {"value": "CUSTOM", "label": "Custom..."}
            ]
        },
        {
            "name": "custom_model_repo",
            "label": "Custom model repo",
            "type": "STRING",
            "description": "Enter the name of a Hugging Face repo",
            "mandatory": false,
            "visibilityCondition": "model.model_repo == 'CUSTOM'"
        },
        {
            "name": "revision",
            "label": "Model revision",
            "type": "SELECT",
            "description": "Revision to download. \"fp16\" is intended to be used with half precision (enabled in the recipe settings)",
            "defaultValue": "main",
            "mandatory": true,
            "getChoicesFromPython": true,
            "triggerParameters": ["model_repo", "custom_model_repo", "hugging_face_credentials"]
        },
        {
            "name": "hugging_face_credentials",
            "label": "Hugging Face credentials",
            "type": "PRESET",
            "description": "User credentials used to access Hugging Face",
            "parameterSetId": "hugging-face-credentials",
            "mandatory": true
        }
    ],
    "permissions": ["WRITE_CONF"],
    "resultType": "HTML",
    "macroRoles": [
        {
            "type": "PROJECT_MACROS"
        },
        {
            "type": "MANAGED_FOLDER",
            "targetParamsKey": "weights_folder"
        }
    ]
}
